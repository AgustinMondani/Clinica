<div class="solicitar-turno-container">

  <h2>Solicitar Turno</h2>

  <div *ngIf="mensaje" class="mensaje" [ngClass]="{
    'error': tipoMensaje === 'error',
    'success': tipoMensaje === 'success',
    'info': tipoMensaje === 'info'
  }">
    {{ mensaje }}
  </div>

  <div class="especialidades-container">
    <h3>Seleccione una especialidad</h3>
    <div class="especialidades-grid">
      <button
        *ngFor="let esp of especialidades"
        (click)="seleccionarEspecialidad(esp.nombre)"
        [class.seleccionado]="esp.nombre === especialidadSeleccionada"
      >
        <img [src]="esp.imagen || 'assets/img/default-especialidad.jpg'" [alt]="esp.nombre" />
        <span>{{ esp.nombre }}</span>
      </button>
    </div>
  </div>

  <div *ngIf="especialistasFiltrados().length > 0" class="especialistas-container">
    <h3>Seleccione un especialista</h3>
    <div class="especialistas-grid">
      <button
        *ngFor="let esp of especialistasFiltrados()"
        (click)="seleccionarEspecialista(esp)"
        [class.seleccionado]="esp === especialistaSeleccionado"
      >
        <img [src]="esp.imagen || 'assets/img/default-user.png'" [alt]="esp.nombre" />
        <span>{{ esp.nombre }} {{ esp.apellido }}</span>
      </button>
    </div>
  </div>

  <div *appMostrarAdmin="true" class="form-group">
    <label>Paciente:</label>
    <select [(ngModel)]="pacienteSeleccionado">
      <option [ngValue]="null">Seleccione un paciente</option>
      <option *ngFor="let paciente of pacientes" [value]="paciente.id">
        {{ paciente.nombre }} {{ paciente.apellido }}
      </option>
    </select>
  </div>

  <div *ngIf="fechasDisponibles.length > 0" class="fechas">
    <h3>Seleccione una fecha:</h3>
    <ul>
      <li *ngFor="let fecha of fechasDisponibles" (click)="seleccionarFecha(fecha.iso)" [class.seleccionado]="fecha.iso === fechaSeleccionada">
        {{ fecha.texto }}
      </li>
    </ul>
  </div>

  <div *ngIf="horariosDisponibles.length > 0" class="horarios">
    <h3>Seleccione un horario:</h3>
    <div class="horarios-grid">
      <button
        *ngFor="let h of horariosDisponibles"
        [disabled]="h.ocupado"
        [class.ocupado]="h.ocupado"
        [class.seleccionado]="h.hora === horarioSeleccionado"
        (click)="horarioSeleccionado = h.hora"
      >
        {{ h.hora }}
      </button>
    </div>
  </div>

  <button class="btn-confirmar" (click)="confirmarTurno()" [disabled]="!horarioSeleccionado || !fechaSeleccionada">
    Confirmar Turno
  </button>

</div>
